# Phase 2.1: TypeScript Migration - Context

**Gathered:** 2026-02-24
**Status:** Ready for planning

<domain>
## Phase Boundary

Convert the entire `src/` codebase from plain JavaScript to TypeScript with a proper build pipeline (tsc), ESLint with TypeScript rules, and strict type checking. Also migrate test files. The goal is better type safety, IDE completions, and code quality enforcement before Discovery UX work begins.

Creating new features, adding capabilities, or changing CLI behavior are out of scope — this is a code quality migration only.

</domain>

<decisions>
## Implementation Decisions

### Build Toolchain
- Use **tsc** (TypeScript compiler) as the build tool — no esbuild or tsup
- Output format: **ESM** (matches existing `"type": "module"` in package.json)
- Compiled output goes to **`dist/`** — `package.json` ships `dist/`, `components.json`, `README.md` (remove `src/` from `files`)
- Emit **declaration files** (`.d.ts`) for type information and future library use
- `bin/index.js` updated to import from `dist/` (e.g., `import '../dist/index.js'`)

### TypeScript Strictness
- Enable **full strict mode** (`strict: true` in tsconfig)
- Target **Node 22** — update `engines` field to `>=22`
- tsconfig settings: `target: "ES2023"`, `module: "NodeNext"`, `moduleResolution: "NodeNext"`
- Hard-to-type cases: use `any` with `// TODO: type this properly` comments — clean up iteratively
- **No path aliases** — keep relative imports throughout

### ESLint Configuration
- Base rule set: **`@typescript-eslint/recommended`**
- Config format: **flat config** (`eslint.config.js`) — ESLint v9+ standard
- Scope: **error detection only** — no Prettier integration, no style rules
- ESLint runs as a **separate `npm run lint` script** — does not block the build

### Migration Strategy
- Convert **all `src/**/*.js` files at once** — rename to `.ts`, then fix type errors
- **Convert JSDoc to TypeScript types** — replace `@param`/`@returns` with proper TS parameter and return types; remove JSDoc once types are in code
- **Migrate tests to TypeScript** as well — all test files become `.test.ts`
- No incremental/allowJs approach — full migration in one pass

</decisions>

<specifics>
## Specific Ideas

- Update `engines` from `>=20` to `>=22` as part of this migration
- The `scripts/build-catalog.js` file (if not in `src/`) may stay as JS if it's a standalone build script — Claude should check and decide
- `bin/index.js` stays as `.js` (it's the entry point shim), but it imports from compiled `dist/`

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope.

</deferred>

---

*Phase: 02.1-typescript-migration*
*Context gathered: 2026-02-24*
