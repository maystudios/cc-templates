---
phase: 02.1-typescript-migration
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - eslint.config.js
  - .gitignore
autonomous: true
requirements: []

must_haves:
  truths:
    - "npm install --save-dev succeeds with all TypeScript and ESLint devDependencies"
    - "tsconfig.json exists with NodeNext ESM strict settings targeting Node 22"
    - "eslint.config.js exists using typescript-eslint flat config"
    - "package.json has build, lint, and prepublishOnly scripts; files field ships dist/ not src/"
    - "dist/ is listed in .gitignore"
  artifacts:
    - path: "tsconfig.json"
      provides: "TypeScript compiler configuration"
      contains: "NodeNext"
    - path: "eslint.config.js"
      provides: "ESLint v9 flat config with TypeScript rules"
      contains: "typescript-eslint"
    - path: "package.json"
      provides: "Updated scripts and files fields"
      contains: "dist/"
  key_links:
    - from: "tsconfig.json"
      to: "src/"
      via: "include: [src/**/*]"
      pattern: "\"include\".*src"
    - from: "package.json"
      to: "dist/"
      via: "files field"
      pattern: "\"dist/\""
---

<objective>
Install TypeScript + ESLint devDependencies and create the build configuration files (tsconfig.json, eslint.config.js). Update package.json scripts and files field. Add dist/ to .gitignore.

Purpose: Establishes the build foundation before any source file migration begins. Nothing compiles without this in place.
Output: tsconfig.json, eslint.config.js, updated package.json, updated .gitignore.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.1-typescript-migration/02.1-CONTEXT.md
@.planning/phases/02.1-typescript-migration/02.1-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install devDependencies</name>
  <files>package.json</files>
  <action>
Run the following command to install all TypeScript and ESLint devDependencies:

```
npm install --save-dev typescript @types/node@22 @types/js-yaml @types/write-file-atomic eslint @eslint/js typescript-eslint
```

Do NOT install @types/chalk or @types/commander — chalk 5.x and commander 14.x ship bundled types.
Do NOT install tsup or esbuild — tsc is the locked build tool.

After installation verify package.json devDependencies contains all six packages: typescript, @types/node, @types/js-yaml, @types/write-file-atomic, eslint, @eslint/js, typescript-eslint.
  </action>
  <verify>
    <automated>node -e "const p = JSON.parse(require('fs').readFileSync('package.json','utf8')); const d = p.devDependencies; ['typescript','@types/node','@types/js-yaml','@types/write-file-atomic','eslint','@eslint/js','typescript-eslint'].forEach(k => { if(!d[k]) throw new Error('Missing: ' + k) }); console.log('All devDeps present')"</automated>
  </verify>
  <done>package.json devDependencies contains typescript, @types/node, @types/js-yaml, @types/write-file-atomic, eslint, @eslint/js, typescript-eslint. node_modules updated.</done>
</task>

<task type="auto">
  <name>Task 2: Create tsconfig.json, eslint.config.js, update package.json scripts and .gitignore</name>
  <files>tsconfig.json, eslint.config.js, package.json, .gitignore</files>
  <action>
**Create tsconfig.json** at project root:

```json
{
  "compilerOptions": {
    "target": "ES2023",
    "module": "NodeNext",
    "moduleResolution": "NodeNext",
    "rootDir": "./src",
    "outDir": "./dist",
    "declaration": true,
    "declarationMap": true,
    "strict": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

**Create eslint.config.js** at project root (plain .js because package.json has "type": "module"):

```javascript
import eslint from '@eslint/js';
import tseslint from 'typescript-eslint';

export default tseslint.config(
  eslint.configs.recommended,
  tseslint.configs.recommended,
);
```

**Update package.json** — make these changes:
1. `scripts.build`: change from `"node scripts/build-catalog.js"` to `"node scripts/build-catalog.js && tsc"` — preserves catalog generation AND adds TypeScript compile step
2. `scripts.lint`: add `"eslint src/"` (new key)
3. `scripts.prepublishOnly`: keep as `"npm run build"`
4. `files`: replace `"src/"` with `"dist/"` — keep bin/, components.json, README.md
5. `engines.node`: change from `">=20"` to `">=22"`

Final package.json `scripts` and `files` sections:
```json
"scripts": {
  "build": "node scripts/build-catalog.js && tsc",
  "lint": "eslint src/",
  "prepublishOnly": "npm run build"
},
"files": [
  "bin/",
  "dist/",
  "components.json",
  "README.md"
],
"engines": {
  "node": ">=22"
}
```

**Update .gitignore** — add `dist/` on its own line (check if it is already present before adding).
  </action>
  <verify>
    <automated>node -e "
const fs = require('fs');
// tsconfig check
const ts = JSON.parse(fs.readFileSync('tsconfig.json','utf8'));
if (ts.compilerOptions.module !== 'NodeNext') throw new Error('tsconfig module not NodeNext');
if (ts.compilerOptions.strict !== true) throw new Error('tsconfig strict not true');
if (ts.compilerOptions.outDir !== './dist') throw new Error('tsconfig outDir not dist');
// eslint config exists
if (!fs.existsSync('eslint.config.js')) throw new Error('eslint.config.js missing');
// package.json checks
const p = JSON.parse(fs.readFileSync('package.json','utf8'));
if (!p.scripts.build.includes('tsc')) throw new Error('build script missing tsc');
if (!p.scripts.lint) throw new Error('lint script missing');
if (!p.files.includes('dist/')) throw new Error('files missing dist/');
if (p.files.includes('src/')) throw new Error('files still has src/');
if (p.engines.node !== '>=22') throw new Error('engines not >=22');
// gitignore check
const gi = fs.readFileSync('.gitignore','utf8');
if (!gi.includes('dist/')) throw new Error('.gitignore missing dist/');
console.log('All config checks passed');
"</automated>
  </verify>
  <done>tsconfig.json exists with NodeNext/strict/outDir:dist settings. eslint.config.js exists with typescript-eslint config. package.json build script runs catalog then tsc, lint script exists, files ships dist/ not src/, engines >=22. .gitignore includes dist/.</done>
</task>

</tasks>

<verification>
Run: `npx tsc --version` — confirms TypeScript is installed
Run: `npx eslint --version` — confirms ESLint is installed
Run: `node -e "require('./tsconfig.json')"` — confirms tsconfig.json is valid JSON
Run: `node -e "const p = require('./package.json'); console.log(p.scripts.build, p.files)"` — confirms scripts and files
</verification>

<success_criteria>
- All devDependencies installed (no npm errors)
- tsconfig.json valid with NodeNext, strict, outDir ./dist
- eslint.config.js exists and is valid ESM
- package.json: build runs catalog + tsc, lint script present, files has dist/ not src/, engines >=22
- .gitignore includes dist/
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-typescript-migration/02.1-01-SUMMARY.md`
</output>
